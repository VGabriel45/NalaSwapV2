{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getEnvHardhatArguments = exports.getEnvVariablesMap = exports.paramNameToEnvVariable = void 0;\n\nconst ArgumentsParser_1 = require(\"../../cli/ArgumentsParser\");\n\nconst unsafe_1 = require(\"../../util/unsafe\");\n\nconst errors_1 = require(\"../errors\");\n\nconst errors_list_1 = require(\"../errors-list\");\n\nconst HARDHAT_ENV_ARGUMENT_PREFIX = \"HARDHAT_\";\n\nfunction paramNameToEnvVariable(paramName) {\n  // We create it starting from the result of ArgumentsParser.paramNameToCLA\n  // so it's easier to explain and understand their equivalences.\n  return ArgumentsParser_1.ArgumentsParser.paramNameToCLA(paramName).replace(ArgumentsParser_1.ArgumentsParser.PARAM_PREFIX, HARDHAT_ENV_ARGUMENT_PREFIX).replace(/-/g, \"_\").toUpperCase();\n}\n\nexports.paramNameToEnvVariable = paramNameToEnvVariable;\n\nfunction getEnvVariablesMap(hardhatArguments) {\n  const values = {};\n\n  for (const [name, value] of Object.entries(hardhatArguments)) {\n    if (value === undefined) {\n      continue;\n    }\n\n    values[paramNameToEnvVariable(name)] = value.toString();\n  }\n\n  return values;\n}\n\nexports.getEnvVariablesMap = getEnvVariablesMap;\n\nfunction getEnvHardhatArguments(paramDefinitions, envVariables) {\n  const envArgs = {};\n\n  for (const paramName of (0, unsafe_1.unsafeObjectKeys)(paramDefinitions)) {\n    const definition = paramDefinitions[paramName];\n    const envVarName = paramNameToEnvVariable(paramName);\n    const rawValue = envVariables[envVarName];\n\n    if (rawValue !== undefined) {\n      try {\n        envArgs[paramName] = definition.type.parse(paramName, rawValue);\n      } catch (error) {\n        if (error instanceof Error) {\n          throw new errors_1.HardhatError(errors_list_1.ERRORS.ARGUMENTS.INVALID_ENV_VAR_VALUE, {\n            varName: envVarName,\n            value: rawValue\n          }, error);\n        } // eslint-disable-next-line @nomiclabs/hardhat-internal-rules/only-hardhat-error\n\n\n        throw error;\n      }\n    } else {\n      envArgs[paramName] = definition.defaultValue;\n    }\n  } // TODO: This is a little type-unsafe, but we know we have all the needed arguments\n\n\n  return envArgs;\n}\n\nexports.getEnvHardhatArguments = getEnvHardhatArguments;","map":{"version":3,"mappings":";;;;;;;AAGA;;AACA;;AACA;;AACA;;AAEA,MAAMA,2BAA2B,GAAG,UAApC;;AAEA,SAAgBC,sBAAhB,CAAuCC,SAAvC,EAAwD;EACtD;EACA;EACA,OAAOC,kCAAgBC,cAAhB,CAA+BF,SAA/B,EACJG,OADI,CACIF,kCAAgBG,YADpB,EACkCN,2BADlC,EAEJK,OAFI,CAEI,IAFJ,EAEU,GAFV,EAGJE,WAHI,EAAP;AAID;;AAPDC;;AASA,SAAgBC,kBAAhB,CAAmCC,gBAAnC,EAAqE;EAGnE,MAAMC,MAAM,GAAiC,EAA7C;;EAEA,KAAK,MAAM,CAACC,IAAD,EAAOC,KAAP,CAAX,IAA4BC,MAAM,CAACC,OAAP,CAAeL,gBAAf,CAA5B,EAA8D;IAC5D,IAAIG,KAAK,KAAKG,SAAd,EAAyB;MACvB;IACD;;IAEDL,MAAM,CAACV,sBAAsB,CAACW,IAAD,CAAvB,CAAN,GAAuCC,KAAK,CAACI,QAAN,EAAvC;EACD;;EAED,OAAON,MAAP;AACD;;AAdDH;;AAgBA,SAAgBU,sBAAhB,CACEC,gBADF,EAEEC,YAFF,EAE0B;EAExB,MAAMC,OAAO,GAAQ,EAArB;;EAEA,KAAK,MAAMnB,SAAX,IAAwB,+BAAiBiB,gBAAjB,CAAxB,EAA4D;IAC1D,MAAMG,UAAU,GAAGH,gBAAgB,CAACjB,SAAD,CAAnC;IACA,MAAMqB,UAAU,GAAGtB,sBAAsB,CAACC,SAAD,CAAzC;IACA,MAAMsB,QAAQ,GAAGJ,YAAY,CAACG,UAAD,CAA7B;;IAEA,IAAIC,QAAQ,KAAKR,SAAjB,EAA4B;MAC1B,IAAI;QACFK,OAAO,CAACnB,SAAD,CAAP,GAAqBoB,UAAU,CAACG,IAAX,CAAgBC,KAAhB,CAAsBxB,SAAtB,EAAiCsB,QAAjC,CAArB;MACD,CAFD,CAEE,OAAOG,KAAP,EAAc;QACd,IAAIA,KAAK,YAAYC,KAArB,EAA4B;UAC1B,MAAM,IAAIC,qBAAJ,CACJC,qBAAOC,SAAP,CAAiBC,qBADb,EAEJ;YACEC,OAAO,EAAEV,UADX;YAEEV,KAAK,EAAEW;UAFT,CAFI,EAMJG,KANI,CAAN;QAQD,CAVa,CAYd;;;QACA,MAAMA,KAAN;MACD;IACF,CAlBD,MAkBO;MACLN,OAAO,CAACnB,SAAD,CAAP,GAAqBoB,UAAU,CAACY,YAAhC;IACD;EACF,CA9BuB,CAgCxB;;;EACA,OAAOb,OAAP;AACD;;AApCDb","names":["HARDHAT_ENV_ARGUMENT_PREFIX","paramNameToEnvVariable","paramName","ArgumentsParser_1","paramNameToCLA","replace","PARAM_PREFIX","toUpperCase","exports","getEnvVariablesMap","hardhatArguments","values","name","value","Object","entries","undefined","toString","getEnvHardhatArguments","paramDefinitions","envVariables","envArgs","definition","envVarName","rawValue","type","parse","error","Error","errors_1","errors_list_1","ARGUMENTS","INVALID_ENV_VAR_VALUE","varName","defaultValue"],"sourceRoot":"","sources":["../../../src/internal/core/params/env-variables.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}